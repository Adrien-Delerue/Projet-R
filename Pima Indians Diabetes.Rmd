---
title: "PROJECT 4"
output: 
  html_document:
    toc: true     
    toc_float: true
    df_print: paged
    css: "Pima_Indians_Diabetes.css"
date: "2025-10-22"
---

# Pima Diabetes -Detecting Diabetes from Imperfect Medical Data

The project aims to predict diabetes in Pima Indian women using imperfect medical data.\

After cleaning invalid values, features are standardized and categorized, visualizations are created to explore patterns, and models (Logistic Regression and KNN) are trained and compared to show the impact of data cleaning.

```{r include=FALSE}
#install.packages("dplyr")
library(dplyr)
```

```{r echo=FALSE}
#Loading the dataset
diabetes = read.csv("diabetes.csv", head=TRUE, sep=",")
summary(diabetes)
```

# Step 1 : Data Cleaning and Preparation

First we are going to replace all the impossible values, such as :

-   the Glucose level at 0

-   the Blood Pressure at 0

-   the Skin Thickness at 0

-   the BMI at 0

-   and the Diabetes Pedigree Function at 0 We obtain the following summary :

```{r echo=FALSE}
#mutating each columns concern, if a value equals 0, it's replaced by an NA value
diabetes <- diabetes %>%
  mutate(
    Glucose = na_if(Glucose, 0),
    BloodPressure = na_if(BloodPressure, 0),
    SkinThickness = na_if(SkinThickness, 0),
    BMI = na_if(BMI, 0),
    DiabetesPedigreeFunction = na_if(DiabetesPedigreeFunction, 0),
  )
summary(diabetes)
```

Now we are going to replace those NA values by the median of each columns. We obtain the following summary :

```{r echo=FALSE}
#mutating each columns concern, if a value equals NA, it's replaced by the median of the corresponding columns else it stays the same
diabetes <- diabetes %>%
  mutate(
    Glucose = if_else(is.na(Glucose), median(Glucose, na.rm = TRUE), Glucose),
    BloodPressure = if_else(is.na(BloodPressure), median(BloodPressure, na.rm = TRUE), BloodPressure),
    SkinThickness = if_else(is.na(SkinThickness), median(SkinThickness, na.rm = TRUE), SkinThickness),
    BMI = if_else(is.na(BMI), median(BMI, na.rm = TRUE), BMI),
    DiabetesPedigreeFunction = if_else(is.na(DiabetesPedigreeFunction), median(DiabetesPedigreeFunction, na.rm = TRUE), DiabetesPedigreeFunction)
  )

summary(diabetes)
```

This is the **post cleaning verification**, unlike the previous summary we can see in this one that we don't have any NA Values left. Our data set is now cleared.

```{r}
diabetes_var<-colnames(diabetes)
diabetes_var_without_outcome<-diabetes_var[diabetes_var!="Outcome"]
diabetes_scaled <-diabetes %>% mutate_at(diabetes_var_without_outcome, ~(scale(.) %>% as.vector))
diabetes_scaled
```

# Step 3: Visualization and Exploration (with ggplot2)

```{r}
not_cleaned_diabetes = read.csv("diabetes.csv", head=TRUE, sep=",")
```

`not_cleaned_diabete` is our data set before the first step, so not cleaned at all. with missing values and incoherences.

```{r}
library(ggplot2)
p1 <- ggplot(not_cleaned_diabetes, aes(x = Glucose, fill = as.factor(Outcome))) +
  geom_density(alpha = 0.5) +
  labs(title = "Glucose (not cleaned)", x = "Glucose", y = "Density") +
  theme_minimal()

p2 <- ggplot(diabetes, aes(x = Glucose, fill = as.factor(Outcome))) +
  geom_density(alpha = 0.5) +
  labs(title = "Glucose (cleaned)", x = "Glucose", y = "Density") +
  theme_minimal()

library(gridExtra)
grid.arrange(p1, p2, ncol = 2)
```

The **red curve** represent non-diabetic's patient. Their curve is centered around lower glucose values. In the other han, the **blue curve** are diabetic's patient is shifted to the right, indicating higher glucose levels. The blue curve extends further right, suggesting greater variability in glucose levels among diabetics.
